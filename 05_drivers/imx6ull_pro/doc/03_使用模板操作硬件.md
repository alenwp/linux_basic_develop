# 使用模板操作硬件

## 1. LED



### 1.1 IMX6ULL

![image-20221104145051700](pic/71_imx6ull_pro_led.png)



### 1.2 STM32MP157

第1步：确认引脚编号并修改led_drv.c

![image-20221104150836218](pic/72_stm32mp157_led.png)



PA10的编号：10

PG8的编号：96+8=104



第2步：修改设备树`arch/arm/boot/dts/stm32mp15xx-100ask.dtsi`

![image-20221104153004214](pic/73_stm32mp157_led_dts.png)



第3步：编译设备树

```shell
make dtbs
```



第4步：替换设备树

```shell
// Ubuntu
cp arch/arm/boot/dts/stm32mp157c-100ask-512d-lcd-v1.dtb ~/nfs_rootfs/

// 开发板
mount /dev/mmcblk2p2 /boot
cp /mnt/stm32mp157c-100ask-512d-lcd-v1.dtb  /boot
```





### 1.3 D1H

![image-20221104154449978](pic/74_d1h_led.png)



第1步：确认引脚编号

![image-20221104155346252](pic/75_d1h_debugfs.png)



在arch/risc/boot/dts/board.dts里搜上图的红框中的文字，确认引脚是哪个，根据它们的编号推理出：

* 每个PORT占据32个引脚编号
* 反推出PC1的编号是65



## 2. 按键



## 3. 红外感应



## 4. 超声波测距



## 5. 步进电机